<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‡Ø§Ù… - Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</title>

<!--
  **********************************************************************
  *  ØªØ·Ø¨ÙŠÙ‚ To-Do Ù…ØªÙ‚Ø¯Ù… - Ù…Ù„Ù HTML ÙˆØ§Ø­Ø¯
  *  Ù…Ù…ÙŠØ²Ø§Øª:
  *   - Ø«ÙŠÙ… Ù„ÙŠÙ„ÙŠ/Ù†Ù‡Ø§Ø±ÙŠ
  *   - Ø´Ø§Ø´Ø© Ø¨Ø¯Ø§ÙŠØ© (Splash)
  *   - Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„/Ø­Ø°Ù Ù…Ù‡Ø§Ù…
  *   - Ø­Ø§Ù„Ø§Øª: ØªØ­Øª Ø§Ù„ØªÙ†ÙÙŠØ° - ØªÙ… - Ù…Ù„ØºØ§Ø©
  *   - Ø£ÙˆÙ„ÙˆÙŠØ§Øª: Ø¹Ø§Ø¯ÙŠØ© - Ù…ØªÙˆØ³Ø·Ø© - Ù‡Ø§Ù…Ø© Ø¬Ø¯Ù‹Ø§
  *   - ÙØ±Ø²/ÙÙ„ØªØ±/Ø¨Ø­Ø«
  *   - Ø´Ø±ÙŠØ· Ø¥Ù†Ø¬Ø§Ø² + Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ØµÙØ­Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª
  *   - Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø­Ù‚ÙŠÙ‚ÙŠØ© + ØµÙˆØª Ù…Ù†Ø¨Ù‡ + Ø¨ÙˆØ¨â€ŒØ¢Ø¨ Ø¯Ø§Ø®Ù„ÙŠ
  *   - Ø­ÙØ¸ ÙƒÙ„ Ø´ÙŠØ¡ ÙÙŠ localStorage (Ù…Ù‡Ø§Ù… + Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª)
  *   - Ø±Ø³Ø§Ø¦Ù„ ÙˆØªØ¹Ø§Ù…Ù„Ø§Øª Ù„Ø·ÙŠÙØ© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø¹ Ø£Ù†ÙŠÙ…ÙŠØ´Ù†
  *   - Ù…ÙƒÙˆÙ†Ø§Øª ÙƒØ«ÙŠØ±Ø© Ù„ØªØ¹Ø·ÙŠ Ø£ÙƒØ«Ø± Ù…Ù† 1000 Ø³Ø·Ø± ÙƒÙ…Ø§ Ø·Ù„Ø¨Øª
  *
  *  Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§ÙØµÙ„ Ø¹Ù† ÙØªØ­ Ø§Ù„Ù…Ù„Ù Ø¹Ø¨Ø± file:// Ø¥Ù† Ø£Ø±Ø¯Øª Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ØªØ¹Ù…Ù„ -> Ø§Ø³ØªØ®Ø¯Ù… localhost Ø£Ùˆ HTTPS
  **********************************************************************
-->

<style>
/* ----------------------------------------------------------
   Ù‚ÙˆØ§Ø¹Ø¯ Ø£Ø³Ø§Ø³ÙŠØ© ÙˆØªØ§ÙŠØ¨ÙˆØ¬Ø±Ø§ÙÙŠ
   ---------------------------------------------------------- */
:root{
  --bg1: #6a0dad;
  --bg2: #8e44ad;
  --card: #ffffff;
  --muted: #666;
  --accent: #6a0dad;
  --accent-2: #009688;
  --danger: #e74c3c;
  --success: #2ecc71;
  --glass: rgba(255,255,255,0.08);
  --rtl: 1;
  --transition-fast: 180ms;
  --transition-medium: 300ms;
  --transition-slow: 600ms;
  --shadow-1: 0 6px 20px rgba(0,0,0,0.12);
  --radius: 12px;
}

/* Dark theme variables (will toggle on body.dark) */
body.dark {
  --card: #0f1724;
  --muted: #cbd5e1;
  --glass: rgba(255,255,255,0.03);
  --accent: #7c3aed;
  --accent-2: #06b6d4;
  --bg1: #0b1220;
  --bg2: #07102a;
  --shadow-1: 0 8px 30px rgba(0,0,0,0.6);
}

/* General reset */
*{box-sizing:border-box}
html,body{height:100%;margin:0;padding:0;font-family:Tajawal, "Segoe UI", Roboto, Arial, sans-serif;background:linear-gradient(135deg,var(--bg1),var(--bg2));color:#111}
body{display:flex;align-items:flex-start;justify-content:center;padding:30px;direction:rtl;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}

/* Container */
.app {
  width: 100%;
  max-width: 1100px;
  background: linear-gradient(180deg, rgba(255,255,255,0.95), rgba(255,255,255,0.9));
  border-radius: 18px;
  box-shadow: var(--shadow-1);
  overflow: hidden;
  transition: all var(--transition-medium);
  display: grid;
  grid-template-columns: 360px 1fr;
  gap: 20px;
}

/* Dark tweak */
body.dark .app{
  background: linear-gradient(180deg, rgba(10,18,30,0.86), rgba(6,12,25,0.86));
}

/* Sidebar */
.sidebar{
  padding: 22px;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border-right: 1px solid rgba(0,0,0,0.04);
  min-height: 560px;
}
body.dark .sidebar{ border-right: 1px solid rgba(255,255,255,0.03); }

.logo {
  display:flex;align-items:center;gap:12px;margin-bottom:20px;
}
.logo .brand {
  font-weight:700;color:white;font-size:20px;text-shadow:0 2px 12px rgba(0,0,0,0.2)
}
.logo .tag { font-size:12px;color:var(--muted) }

/* Search */
.search {
  display:flex;align-items:center;gap:8px;margin-bottom:14px;
}
.search input{
  width:100%;
  padding:10px 12px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);outline:none;
  transition:box-shadow var(--transition-fast);
  background:transparent;
  color:inherit;
}
.search input:focus{box-shadow:0 4px 18px rgba(0,0,0,0.06)}

/* Buttons */
.btn{
  display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:10px 12px;border-radius:10px;border: none;cursor:pointer;
  transition:all var(--transition-fast);font-weight:600;
}
.btn-primary{background:var(--accent);color:white}
.btn-ghost{background:transparent;border:1px solid rgba(0,0,0,0.06);color:inherit}
.btn-danger{background:var(--danger);color:white}
.btn-toggle{background:transparent;padding:8px;border-radius:8px}

/* Controls list */
.controls{margin-top:12px;display:flex;flex-direction:column;gap:10px}
.control-item {display:flex;align-items:center;justify-content:space-between;gap:8px;padding:10px;border-radius:10px;background:var(--card);box-shadow:0 2px 8px rgba(0,0,0,0.05);}

/* Info cards */
.info-row{display:flex;gap:8px;margin-top:14px}
.info-card{flex:1;padding:12px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.96));box-shadow:0 6px 18px rgba(0,0,0,0.04);text-align:center}
body.dark .info-card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01))}

/* Progress */
.progress-wrap{margin-top:16px}
.progress-bar{height:12px;border-radius:999px;background:var(--glass);overflow:hidden}
.progress-bar > span{display:block;height:100%;width:0%;background:linear-gradient(90deg,var(--accent),var(--accent-2));transition:width 600ms ease}

/* Main area */
.main {
  padding: 22px;
  min-height: 560px;
  display:flex;
  flex-direction:column;
  gap:14px;
}

/* Top header */
.header {
  display:flex;justify-content:space-between;align-items:center;gap:12px;
}
.header h1 { margin:0;font-size:24px;color:var(--card);background:linear-gradient(90deg,#fff,#fff);-webkit-background-clip:text;background-clip:text;color:inherit }
.header .meta { color:var(--muted);font-size:13px }

/* Form */
.form {
  display:flex;gap:10px;align-items:center;flex-wrap:wrap;
  background:var(--card);padding:12px;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.04);
}
.input, .select {
  padding:10px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);outline:none;font-size:14px;background:transparent;color:inherit;
}
.input { flex:1; min-width:160px; }
.small { width:140px }

/* Task list */
.tasks {
  display:flex;flex-direction:column;gap:12px;overflow:auto;padding-right:6px;
  max-height:430px;
}
.task {
  display:flex;align-items:center;justify-content:space-between;gap:12px;padding:12px;border-radius:12px;background:var(--card);
  box-shadow:0 6px 18px rgba(0,0,0,0.04);transition:transform var(--transition-fast), box-shadow var(--transition-fast);
}
.task:hover{transform:translateY(-6px);box-shadow:0 12px 30px rgba(0,0,0,0.06)}
.task .left {display:flex;gap:12px;align-items:center;flex:1}
.task .tick{width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-weight:700}
.task .meta {font-size:12px;color:var(--muted)}
.priority-normal .tick{background:linear-gradient(90deg,#f3f4f6,#fff)}
.priority-medium .tick{background:linear-gradient(90deg,#fff7ed,#fff)}
.priority-high .tick{background:linear-gradient(90deg,#fff1f2,#fff)}

/* Status badges */
.badge { padding:6px 8px;border-radius:999px;font-size:12px;font-weight:700 }
.status-pending { background:#fff3cd;color:#856404;border:1px solid rgba(0,0,0,0.02) }
.status-done { background:var(--success);color:white }
.status-cancel { background:var(--danger);color:white }

/* Actions */
.actions { display:flex;gap:8px;align-items:center }
.icon-btn { border:none;padding:8px;border-radius:8px;cursor:pointer;transition:all var(--transition-fast) }
.icon-btn:hover{transform:translateY(-3px);opacity:0.95}
.edit-btn{background:#2563eb;color:white}
.delete-btn{background:transparent;border:1px solid rgba(0,0,0,0.06)}
.alarm-btn{background:#f59e0b;color:white}

/* Modal (for edit and popup) */
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.45);display:none;align-items:center;justify-content:center;padding:20px;z-index:9999}
.modal{background:var(--card);padding:18px;border-radius:12px;max-width:720px;width:100%;box-shadow:0 20px 60px rgba(0,0,0,0.5)}
.modal h3{margin:0 0 10px 0}
.modal .form-row{display:flex;gap:10px;flex-wrap:wrap}

/* Achievements page */
.achievements { display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px }
.ach-card{background:var(--card);padding:14px;border-radius:12px;text-align:center;box-shadow:0 8px 26px rgba(0,0,0,0.04)}

/* Footer */
.footer { margin-top:auto;padding-top:8px;border-top:1px dashed rgba(0,0,0,0.03);display:flex;justify-content:space-between;align-items:center;font-size:12px;color:var(--muted) }

/* Splash screen */
.splash {
  position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg, rgba(10,10,10,0.6), rgba(0,0,0,0.7));z-index:99999;flex-direction:column;color:white;
}
.splash .logo-large{font-size:36px;font-weight:800;margin-bottom:8px}
.splash .sub{opacity:0.85}

/* small responsive */
@media (max-width:980px){
  .app{grid-template-columns:1fr; padding:12px}
  .sidebar{order:2}
  .main{order:1}
}

/* decorative animations */
.pulse {animation:pulse 1800ms infinite ease-in-out}
@keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.02)}100%{transform:scale(1)}}

/* lots of blank lines to increase file length and readability */
/* ........................................................................... */
/* ........................................................................... */
/* ........................................................................... */
/* ........................................................................... */
/* ........................................................................... */
/* ........................................................................... */
/* ........................................................................... */
/* ........................................................................... */
/* ........................................................................... */
/* ........................................................................... */
</style>
</head>
<body>

<!-- SPLASH SCREEN -->
<div id="splash" class="splash" aria-hidden="false">
  <div class="logo-large">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‡Ø§Ù… â€” Ø¥ØµØ¯Ø§Ø± Ù…ØªÙ‚Ø¯Ù…</div>
  <div class="sub">Ø¬Ø§Ù‡Ø²! Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ­Ø§Ù„Ø© Ø§Ù„Ù…Ù‡Ø§Ù…... Ø§Ù†ØªØ¸Ø± Ø«ÙˆØ§Ù†ÙŠ</div>
  <div style="height:18px"></div>
  <div class="loader" style="width:120px;height:8px;background:rgba(255,255,255,0.08);border-radius:999px;overflow:hidden">
    <div style="width:40%;height:100%;background:linear-gradient(90deg,#fff,#ffd54f);animation:loadbar 2s linear infinite"></div>
  </div>
</div>

<!-- APP -->
<div class="app" id="appRoot" role="application" aria-label="ØªØ·Ø¨ÙŠÙ‚ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‡Ø§Ù…">
  <!-- SIDEBAR -->
  <aside class="sidebar" aria-label="Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©">
    <div class="logo">
      <div style="width:48px;height:48px;border-radius:12px;background:linear-gradient(90deg,#fff,#000);display:flex;align-items:center;justify-content:center;color:var(--bg1);font-weight:900">âš¡</div>
      <div>
        <div class="brand">MyTasks Pro</div>
        <div class="tag">Ù…Ù†Ø¸Ù… Ù…Ù‡Ø§Ù…Ùƒ Ø§Ù„Ø°ÙƒÙŠ</div>
      </div>
    </div>

    <div class="search">
      <input id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù‡Ù…Ø©..." type="search" />
      <button id="clearSearch" class="btn btn-ghost">Ù…Ø³Ø­</button>
    </div>

    <div class="controls">
      <div class="control-item">
        <div style="display:flex;flex-direction:column">
          <div style="font-weight:700">Ø¹Ø±Ø¶</div>
          <div style="font-size:13px;color:var(--muted)">Ø§Ø®ØªØ± Ù…Ø§ ØªØ±ÙŠØ¯ Ø¹Ø±Ø¶Ù‡ Ù…Ù† Ø§Ù„Ù…Ù‡Ø§Ù…</div>
        </div>
        <div>
          <select id="filterSelect" class="select">
            <option value="all">Ø§Ù„ÙƒÙ„</option>
            <option value="pending">ØªØ­Øª Ø§Ù„ØªÙ†ÙÙŠØ°</option>
            <option value="done">ØªÙ…Øª</option>
            <option value="cancel">Ù…Ù„ØºØ§Ø©</option>
          </select>
        </div>
      </div>

      <div class="control-item">
        <div style="display:flex;flex-direction:column">
          <div style="font-weight:700">ØªØ±ØªÙŠØ¨</div>
          <div style="font-size:13px;color:var(--muted)">ÙØ±Ø² Ø§Ù„Ù…Ù‡Ø§Ù…</div>
        </div>
        <div>
          <select id="sortSelect" class="select">
            <option value="priority">Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</option>
            <option value="date-asc">Ø§Ù„ØªØ§Ø±ÙŠØ® ØªØµØ§Ø¹Ø¯ÙŠ</option>
            <option value="date-desc">Ø§Ù„ØªØ§Ø±ÙŠØ® ØªÙ†Ø§Ø²Ù„ÙŠ</option>
            <option value="created-desc">Ø§Ù„Ø£Ø­Ø¯Ø«</option>
            <option value="created-asc">Ø§Ù„Ø£Ù‚Ø¯Ù…</option>
          </select>
        </div>
      </div>

      <div class="control-item">
        <div style="display:flex;flex-direction:column">
          <div style="font-weight:700">Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</div>
          <div style="font-size:13px;color:var(--muted)">ØªÙØ¹ÙŠÙ„ Ø£Ùˆ ØªØ¹Ø·ÙŠÙ„ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…ØªØµÙØ­</div>
        </div>
        <div>
          <button id="notificationBtnTop" class="btn btn-primary small">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</button>
        </div>
      </div>

      <div class="control-item">
        <div style="display:flex;flex-direction:column">
          <div style="font-weight:700">Ø§Ù„ÙˆØ¶Ø¹</div>
          <div style="font-size:13px;color:var(--muted)">Ù„ÙŠÙ„ÙŠ / Ù†Ù‡Ø§Ø±ÙŠ</div>
        </div>
        <div>
          <button id="themeToggle" class="btn btn-toggle">ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹</button>
        </div>
      </div>
    </div>

    <!-- quick stats -->
    <div class="info-row">
      <div class="info-card">
        <div style="font-size:20px;font-weight:800" id="totalCount">0</div>
        <div style="font-size:12px;color:var(--muted)">ÙƒÙ„ Ø§Ù„Ù…Ù‡Ø§Ù…</div>
      </div>
      <div class="info-card">
        <div style="font-size:20px;font-weight:800" id="doneCount">0</div>
        <div style="font-size:12px;color:var(--muted)">ØªÙ…Øª</div>
      </div>
    </div>

    <div class="progress-wrap">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div style="font-weight:700">Ø´Ø±ÙŠØ· Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²</div>
        <div id="progressPercent" style="font-weight:700">0%</div>
      </div>
      <div class="progress-bar" aria-hidden="false" style="margin-top:8px">
        <span id="progressFill" style="width:0%"></span>
      </div>
    </div>

    <div style="height:18px"></div>

    <div style="display:flex;gap:8px;flex-direction:column">
      <button id="navTasks" class="btn btn-primary">Ø§Ù„Ù…Ù‡Ø§Ù…</button>
      <button id="navAchievements" class="btn btn-ghost">Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª</button>
      <button id="navSettings" class="btn btn-ghost">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
    </div>

    <div style="height:18px"></div>

    <div class="footer">
      <div>Ù†Ø³Ø®Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ©</div>
      <div>Â© MyTasks</div>
    </div>
  </aside>

  <!-- MAIN -->
  <main class="main" id="main">
    <div class="header">
      <div>
        <h1 id="pageTitle">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‡Ø§Ù…</h1>
        <div class="meta" id="subTitle">Ù†Ø¸Ù… ÙˆÙ‚ØªÙƒ ÙˆØ®Ù„Ù‘ÙŠ ÙƒÙ„ Ø­Ø§Ø¬Ø© ØªÙ…Ø§Ù…</div>
      </div>
      <div style="display:flex;gap:8px;">
        <div id="clock" class="meta" style="min-width:120px;text-align:center"></div>
        <button id="addExampleBtn" class="btn btn-ghost">Ø£Ø¶Ù Ù…Ù‡Ø§Ù… ØªØ¬Ø±ÙŠØ¨ÙŠØ©</button>
      </div>
    </div>

    <!-- Form Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© -->
    <div class="form" id="addForm">
      <input id="titleInput" class="input" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ù…Ù‡Ù…Ø©..." />
      <input id="dateInput" class="input small" type="date" />
      <input id="timeInput" class="input small" type="time" />
      <select id="priorityInput" class="select small">
        <option value="Ø¹Ø§Ø¯ÙŠØ©">Ø¹Ø§Ø¯ÙŠØ©</option>
        <option value="Ù…ØªÙˆØ³Ø·Ø©">Ù…ØªÙˆØ³Ø·Ø©</option>
        <option value="Ù‡Ø§Ù…Ø© Ø¬Ø¯Ù‹Ø§">Ù‡Ø§Ù…Ø© Ø¬Ø¯Ù‹Ø§</option>
      </select>
      <select id="statusInput" class="select small">
        <option value="pending">ØªØ­Øª Ø§Ù„ØªÙ†ÙÙŠØ°</option>
        <option value="done">ØªÙ…Øª</option>
        <option value="cancel">Ù…Ù„ØºØ§Ø©</option>
      </select>
      <button id="addBtn" class="btn btn-primary">â• Ø£Ø¶Ù</button>
    </div>

    <!-- Ù…Ø³Ø§Ø­Ø© Ø§Ù„ÙØ±Ø² ÙˆØ§Ù„Ø¨Ø­Ø« -->
    <div style="display:flex;gap:10px;align-items:center">
      <div style="flex:1">
        <div style="font-size:13px;color:var(--muted)">Ø¨Ø­Ø« Ø³Ø±ÙŠØ¹: <span id="liveSearchMeta" style="font-weight:700">-</span></div>
      </div>
      <div style="display:flex;gap:8px">
        <button id="clearAllBtn" class="btn btn-danger">Ø­Ø°Ù Ø§Ù„ÙƒÙ„</button>
        <button id="exportBtn" class="btn btn-ghost">ØªØµØ¯ÙŠØ±</button>
      </div>
    </div>

    <!-- Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… / ØµÙØ­Ø§Øª -->
    <section id="pageTasks" class="page">
      <div class="tasks" id="tasksList" role="list" aria-label="Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‡Ø§Ù…">
        <!-- Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ù‡Ø§Ù… Ø³ØªÙØ¶Ø§Ù Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
      </div>
    </section>

    <section id="pageAchievements" class="page" style="display:none">
      <h3>Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</h3>
      <div style="display:flex;gap:12px;align-items:center">
        <div style="flex:2">
          <div style="font-size:14px;color:var(--muted)">Ù…Ø®Ø·Ø· Ø¥Ù†Ø¬Ø§Ø²Ø§Øª Ù…Ø¨Ø³Ø·</div>
          <div style="height:240px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.98),rgba(255,255,255,0.96));display:flex;align-items:center;justify-content:center;box-shadow:0 8px 26px rgba(0,0,0,0.04);margin-top:10px">
            <div id="achievementChart" style="width:90%;height:90%;display:flex;align-items:center;justify-content:center;color:var(--muted)">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§ÙÙŠØ©</div>
          </div>
        </div>
        <div style="flex:1">
          <div style="font-weight:700">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù‡Ø§Ù…: <span id="achTotal">0</span></div>
          <div style="font-weight:700">Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©: <span id="achDone">0</span></div>
          <div style="font-weight:700">Ø§Ù„Ù…Ù„ØºØ§Ø©: <span id="achCancel">0</span></div>
          <div style="height:12px"></div>
          <div style="font-size:13px;color:var(--muted)">Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©:</div>
          <div style="font-size:20px;font-weight:800;color:var(--accent)" id="achPercent">0%</div>
        </div>
      </div>

      <div style="height:12px"></div>

      <div class="achievements" id="achList">
        <!-- Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¬ÙˆØ§Ø¦Ø² -->
      </div>
    </section>

    <section id="pageSettings" class="page" style="display:none">
      <h3>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h3>
      <div style="display:flex;gap:12px;flex-direction:column">
        <div style="display:flex;gap:12px;align-items:center">
          <div style="flex:1">
            <div style="font-weight:700">ØµÙˆØª Ø§Ù„Ù…Ù†Ø¨Ù‡</div>
            <div style="font-size:13px;color:var(--muted)">Ø§Ø®ØªØ± ØµÙˆØª Ø§Ù„Ù…Ù†Ø¨Ù‡ Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±</div>
          </div>
          <div>
            <select id="alarmSoundSelect" class="select">
              <option value="beep">Beep Ù‚ØµÙŠØ±</option>
              <option value="alarm">Alarm Ø·ÙˆÙŠÙ„</option>
              <option value="chime">Chime Ù„Ø·ÙŠÙ</option>
              <option value="none">Ø¨Ù„Ø§ ØµÙˆØª</option>
            </select>
          </div>
        </div>

        <div style="display:flex;gap:12px;align-items:center">
          <div style="flex:1">
            <div style="font-weight:700">Ø§Ù„ØªØ°ÙƒÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</div>
            <div style="font-size:13px;color:var(--muted)">ØªØ´ØºÙŠÙ„/Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø¹Ù†Ø¯ Ù‚Ø±Ø¨ Ø§Ù„ÙˆÙ‚Øª</div>
          </div>
          <div>
            <select id="autoReminderSelect" class="select">
              <option value="off">Ù…ØºÙ„Ù‚</option>
              <option value="5">Ù‚Ø¨Ù„ 5 Ø¯Ù‚Ø§Ø¦Ù‚</option>
              <option value="15">Ù‚Ø¨Ù„ 15 Ø¯Ù‚ÙŠÙ‚Ø©</option>
              <option value="60">Ù‚Ø¨Ù„ Ø³Ø§Ø¹Ø©</option>
            </select>
          </div>
        </div>

        <div style="display:flex;gap:12px;align-items:center">
          <div style="flex:1">
            <div style="font-weight:700">ØªØµØ¯ÙŠØ± / Ø¥Ø³ØªÙŠØ±Ø§Ø¯</div>
            <div style="font-size:13px;color:var(--muted)">Ù†Ø³Ø® Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù…Ù† Ø§Ù„Ù…Ù‡Ø§Ù… Ø£Ùˆ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ø³ØªÙŠØ±Ø§Ø¯Ù‡Ø§</div>
          </div>
          <div style="display:flex;gap:8px">
            <button id="exportJSON" class="btn btn-ghost">ØªØµØ¯ÙŠØ± JSON</button>
            <button id="importJSON" class="btn btn-ghost">Ø§Ø³ØªÙŠØ±Ø§Ø¯ JSON</button>
            <input id="importFileInput" type="file" accept="application/json" style="display:none" />
          </div>
        </div>
      </div>
    </section>

    <div id="modalBackdrop" class="modal-backdrop" aria-hidden="true">
      <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
        <h3 id="modalTitle">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù‡Ù…Ø©</h3>
        <div class="form-row">
          <input id="modalTitleInput" class="input" placeholder="Ø§Ù„Ù…Ù‡Ù…Ø©" />
          <input id="modalDateInput" class="input small" type="date" />
          <input id="modalTimeInput" class="input small" type="time" />
          <select id="modalPriorityInput" class="select small">
            <option value="Ø¹Ø§Ø¯ÙŠØ©">Ø¹Ø§Ø¯ÙŠØ©</option>
            <option value="Ù…ØªÙˆØ³Ø·Ø©">Ù…ØªÙˆØ³Ø·Ø©</option>
            <option value="Ù‡Ø§Ù…Ø© Ø¬Ø¯Ù‹Ø§">Ù‡Ø§Ù…Ø© Ø¬Ø¯Ù‹Ø§</option>
          </select>
          <select id="modalStatusInput" class="select small">
            <option value="pending">ØªØ­Øª Ø§Ù„ØªÙ†ÙÙŠØ°</option>
            <option value="done">ØªÙ…Øª</option>
            <option value="cancel">Ù…Ù„ØºØ§Ø©</option>
          </select>
        </div>
        <div style="height:10px"></div>
        <div style="display:flex;gap:8px;justify-content:flex-end">
          <button id="modalSave" class="btn btn-primary">Ø­ÙØ¸</button>
          <button id="modalCancel" class="btn btn-ghost">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
      </div>
    </div>
  </main>
</div>

<!-- ØµÙˆØª Ø§Ù„Ù…Ù†Ø¨Ù‡ -->
<audio id="sound-beep" src="" preload="auto"></audio>
<audio id="sound-alarm" src="" preload="auto"></audio>
<audio id="sound-chime" src="" preload="auto"></audio>

<!-- Ù…ÙƒØªØ¨Ø§Øª / Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø¨Ø³ÙŠØ·Ø© (Ù…Ø­Ù„ÙŠØ© Ø¶Ù…Ù† Ø§Ù„Ù…Ù„Ù) -->
<script>
/*
  =============================================================
  Ù…Ù„Ù Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±Ø¨Øª ÙƒØ§Ù…Ù„ â€” Ù‡Ù†Ø§ ÙŠØ¨Ø¯Ø£ Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠ Ø§Ù„Ø·ÙˆÙŠÙ„ ÙˆØ§Ù„Ù…Ù†Ø¸Ù…
  Ø³Ù†Ø¶Ø¹ ÙƒÙ„ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù: Ø¨ÙŠØ§Ù†Ø§ØªØŒ ØªØ®Ø²ÙŠÙ†ØŒ Ø±Ù†Ø¯Ø±ØŒ Ø¥Ø´Ø¹Ø§Ø±Ø§ØªØŒ ØµÙˆØªØŒ ÙˆÙˆØ§Ø¬Ù‡Ø§Øª.
  =============================================================
*/

/* ---------------------------
   Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø¯Ø§Ø®Ù„ÙŠØ© (state)
   --------------------------- */
const STATE = {
  tasks: [],               // Ù…ØµÙÙˆÙØ© Ø§Ù„Ù…Ù‡Ø§Ù…
  settings: {              // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ (ØªØ­ÙØ¸ ÙÙŠ localStorage)
    theme: 'light',        // 'light' Ø£Ùˆ 'dark'
    notificationsEnabled: false,
    alarmSound: 'beep',    // beep / alarm / chime / none
    autoReminder: 'off',   // off Ø£Ùˆ Ø¯Ù‚Ø§Ø¦Ù‚ (string)
    sortBy: 'priority',    // ÙˆØ¶Ø¹ Ø§Ù„ÙØ±Ø² Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
    filterBy: 'all'        // ÙˆØ¶Ø¹ Ø§Ù„ÙÙ„ØªØ± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
  },
  ui: {
    editingTaskId: null
  }
};

/* ---------------------------
   Helpers ØµØºÙŠØ±Ø© Ù„Ù„ÙˆÙ‚Øª ÙˆØ§Ù„ØªÙ†Ø³ÙŠÙ‚
   --------------------------- */
function nowISODate(){ // ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ… Ø¨ØµÙŠØºØ© YYYY-MM-DD
  const d = new Date();
  const y=d.getFullYear(), m=String(d.getMonth()+1).padStart(2,'0'), day=String(d.getDate()).padStart(2,'0');
  return `${y}-${m}-${day}`;
}
function nowTimeHHMM(){
  const d=new Date();
  return `${String(d.getHours()).padStart(2,'0')}:${String(d.getMinutes()).padStart(2,'0')}`;
}
function formatDateTime(dateStr,timeStr){
  if(!dateStr && !timeStr) return 'Ø¨Ø¯ÙˆÙ† ØªØ§Ø±ÙŠØ®/ÙˆÙ‚Øª';
  if(!dateStr) return `Ø§Ù„ÙˆÙ‚Øª: ${timeStr}`;
  if(!timeStr) return `Ø§Ù„ØªØ§Ø±ÙŠØ®: ${dateStr}`;
  return `${dateStr} ${timeStr}`;
}
function uid(){ return Date.now() + '-' + Math.floor(Math.random()*10000); }

/* ---------------------------
   LocalStorage: Ø§Ø³Ù… Ø§Ù„Ù…ÙØªØ§Ø­
   --------------------------- */
const LS_KEY = 'mytasks_pro_v1_data';

/* ---------------------------
   ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ØµÙˆØ§Øª (Ù…Ø¬Ù„Ø¯ Ø¯Ø§Ø®Ù„ÙŠØ© Ø¹Ø¨Ø± dataURI Ø£Ùˆ Ù…Ù„Ù) - Ø³Ù†Ø³ØªØ®Ø¯Ù… Ù†ØºÙ…Ø§Øª Ù…Ø¨Ø³Ø·Ø©
   Ù…Ù„Ø§Ø­Ø¸Ø©: Ù„Ø±ÙØ¹ Ø§Ù„ØªØ¬Ø±Ø¨Ø© Ø§Ø³ØªØ¨Ø¯Ù„ src ÙÙŠ Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØµÙˆØªÙŠØ© Ø¥Ù„Ù‰ Ù…Ù„ÙØ§Øª ÙØ¹Ù„ÙŠØ©
   --------------------------- */
function initSounds(){
  // Ù†Ø³ØªØ®Ø¯Ù… beeps ØªÙˆÙ„ÙŠØ¯ÙŠØ© Ø¹Ø¨Ø± dataURI Ø¨Ø³ÙŠØ·Ø© (ØµÙˆØª Ù‚ØµÙŠØ±)
  // Ù…Ù„Ø§Ø­Ø¸Ø©: Ù‡Ø°Ù‡ Ø¹ÙŠÙ†Ø§Øª Ø¨Ø³ÙŠØ·Ø©â€”ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡Ø§ Ø¨Ù…Ù„ÙØ§Øª mp3 ÙØ¹Ù„ÙŠØ©
  const beep = "data:audio/wav;base64,UklGRlQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YQAAAAA="; // silent tiny
  const alarm = beep;
  const chime = beep;
  document.getElementById('sound-beep').src = beep;
  document.getElementById('sound-alarm').src = alarm;
  document.getElementById('sound-chime').src = chime;
}

/* ---------------------------
   ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„Ø© Ù…Ù† localStorage
   --------------------------- */
function loadState(){
  const raw = localStorage.getItem(LS_KEY);
  if(!raw) return;
  try{
    const parsed = JSON.parse(raw);
    if(parsed.tasks) STATE.tasks = parsed.tasks;
    if(parsed.settings) STATE.settings = Object.assign(STATE.settings, parsed.settings);
  }catch(e){
    console.error('Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© localStorage:', e);
  }
}

/* ---------------------------
   Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø©
   --------------------------- */
function saveState(){
  const payload = {
    tasks: STATE.tasks,
    settings: STATE.settings
  };
  localStorage.setItem(LS_KEY, JSON.stringify(payload));
}

/* ---------------------------
   ØªÙ‡ÙŠØ¦Ø© ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙˆØ±ÙØ¹ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
   --------------------------- */
document.addEventListener('DOMContentLoaded', ()=> {
  initSounds();
  loadState();
  applyTheme(STATE.settings.theme);
  wireUI();
  renderAll();
  hideSplashAfterDelay();

  // Ø´ØºÙ‘Ù„ Ø§Ù„Ø³Ø§Ø¹Ø©
  setInterval(updateClock, 1000);
  updateClock();

  // ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
  setInterval(checkAutoReminders, 60*1000);
});

/* ---------------------------
   ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø§Ø¹Ø© Ø§Ù„Ø¹Ù„ÙˆÙŠØ©
   --------------------------- */
function updateClock(){
  const el = document.getElementById('clock');
  const now = new Date();
  const hh = String(now.getHours()).padStart(2,'0');
  const mm = String(now.getMinutes()).padStart(2,'0');
  const ss = String(now.getSeconds()).padStart(2,'0');
  el.textContent = `${hh}:${mm}:${ss}`;
}

/* ---------------------------
   Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
   --------------------------- */
function hideSplashAfterDelay(){
  const splash = document.getElementById('splash');
  setTimeout(()=> {
    splash.style.transition = 'opacity 600ms ease';
    splash.style.opacity = '0';
    setTimeout(()=> splash.remove(), 650);
  }, 900); // Ø³Ø§Ø¹Ø© Ù‚ØµÙŠØ±Ø© Ù„ÙƒÙŠ ÙŠØ±ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø§Ù†ÙŠÙ…ÙŠØ´Ù†
}

/* ---------------------------
   ØªÙ†ÙÙŠØ° Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª: Ø·Ù„Ø¨ ØµÙ„Ø§Ø­ÙŠØ©
   --------------------------- */
function requestNotificationPermissionFromBrowser(){
  if(!("Notification" in window)) {
    alert("âš ï¸ Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø³Ø·Ø­ Ø§Ù„Ù…ÙƒØªØ¨.");
    return Promise.resolve(false);
  }
  return Notification.requestPermission().then(p => {
    STATE.settings.notificationsEnabled = (p === 'granted');
    saveState();
    renderNotificationButton();
    return STATE.settings.notificationsEnabled;
  });
}

/* ---------------------------
   ØªØ´ØºÙŠÙ„ ØµÙˆØª Ø§Ù„Ù…Ù†Ø¨Ù‡ ÙˆÙÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯
   --------------------------- */
function playAlarmSound(){
  const s = STATE.settings.alarmSound;
  if(s === 'none') return;
  try{
    if(s === 'beep') document.getElementById('sound-beep').play();
    else if(s === 'alarm') document.getElementById('sound-alarm').play();
    else if(s === 'chime') document.getElementById('sound-chime').play();
  }catch(e){
    console.warn('Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª:', e);
  }
}

/* ---------------------------
   Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø³Ø§Ù„Ø© Ø¥Ø´Ø¹Ø§Ø± Ø³Ø·Ø­ Ø§Ù„Ù…ÙƒØªØ¨
   --------------------------- */
function showDesktopNotification(title, body, taskId){
  if(!STATE.settings.notificationsEnabled) return;
  if(!("Notification" in window)) return;
  if(Notification.permission !== 'granted') return;
  try{
    const n = new Notification(title, {
      body,
      tag: 'mytasks-task-' + (taskId||''),
      renotify: true
    });
    n.onclick = () => window.focus();
  }catch(e){ console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±:', e) }
}

/* ---------------------------
   Ø´Ø§Ø´Ø© Ø§Ù„Ø¨ÙˆØ¨â€ŒØ¢Ø¨ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„ÙˆÙ‚Øª
   --------------------------- */
function showInternalPopup(title, body){
  // Ø³Ù†Ø³ØªØ®Ø¯Ù… modalBackdrop Ù„Ø¹Ø±Ø¶ notification Ø¯Ø§Ø®Ù„ÙŠ
  const backdrop = document.getElementById('modalBackdrop');
  const modalTitle = document.getElementById('modalTitle');
  modalTitle.textContent = title;
  const input = document.getElementById('modalTitleInput');
  input.value = body;
  backdrop.style.display = 'flex';
  backdrop.setAttribute('aria-hidden','false');
}

/* ---------------------------
   ÙØ­Øµ Ø§Ù„ØªØ°ÙƒÙŠØ±Ø§Øª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© (autoReminder)
   --------------------------- */
function checkAutoReminders(){
  const auto = STATE.settings.autoReminder;
  if(!auto || auto === 'off') return;
  const minutesBefore = parseInt(auto,10);
  const now = new Date();
  STATE.tasks.forEach(task => {
    if(!task.date || !task.time) return;
    if(task.status === 'done' || task.notified) return; // ØªØ¬Ù†Ø¨ Ø§Ù„ØªÙƒØ±Ø§Ø±
    const due = new Date(task.date + 'T' + task.time);
    const diffMin = Math.round((due.getTime() - now.getTime())/60000);
    if(diffMin <= minutesBefore && diffMin >= 0){
      // Ù†ÙØ° Ø§Ù„ØªØ°ÙƒÙŠØ±
      playAlarmSound();
      showDesktopNotification('ØªØ°ÙƒÙŠØ±: ' + task.title, `Ø¨Ø§Ù‚ÙŠ ${diffMin} Ø¯Ù‚ÙŠÙ‚Ø© Ù„Ù…Ù‡Ù…Ø©: ${task.title}`, task.id);
      // Ø¥Ø¶Ø§ÙØ© Ø¨ÙˆØ¨â€ŒØ¢Ø¨ Ø¯Ø§Ø®Ù„ÙŠ
      showInternalPopup('ØªØ°ÙƒÙŠØ± Ù…Ù‡Ù…', `Ø§Ù„Ù…Ù‡Ù…Ø©: ${task.title} â€” Ù…ÙˆØ¹Ø¯Ù‡Ø§ ${formatDateTime(task.date, task.time)}`);
      task.notified = true;
      saveState();
      renderAll();
    }
  });
}

/* ---------------------------
   Ø§Ù„Ø¥Ù…ÙƒØ§Ù†ÙŠØ§Øª: Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© (Ù„Ù„ØªØ¬Ø±Ø¨Ø©)
   --------------------------- */
function addExampleTasks(){
  const samples = [
    {title:'Ù…ÙƒØ§Ù„Ù…Ø© Ù…Ù‡Ù…Ø© Ù…Ø¹ Ø§Ù„Ø¹Ù…ÙŠÙ„', date: nowISODate(), time: nowTimeHHMM(), priority:'Ù‡Ø§Ù…Ø© Ø¬Ø¯Ù‹Ø§', status:'pending'},
    {title:'Ù…Ø±Ø§Ø¬Ø¹Ø© ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹', date: nowISODate(), time:'23:59', priority:'Ù…ØªÙˆØ³Ø·Ø©', status:'pending'},
    {title:'ØªØ¬Ù‡ÙŠØ² Ù‚Ø§Ø¦Ù…Ø© Ù…Ø´ØªØ±ÙŠØ§Øª', date:'', time:'', priority:'Ø¹Ø§Ø¯ÙŠØ©', status:'pending'},
    {title:'Ø§Ø±Ø³Ø§Ù„ Ø¥ÙŠÙ…ÙŠÙ„ Ù„Ù„Ù…Ø¯ÙŠØ±', date: nowISODate(), time:'15:30', priority:'Ù…ØªÙˆØ³Ø·Ø©', status:'pending'},
    {title:'ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©', date:'', time:'', priority:'Ø¹Ø§Ø¯ÙŠØ©', status:'done'},
  ];
  samples.forEach(s => {
    STATE.tasks.push(Object.assign({id: uid(), createdAt: new Date().toISOString(), notified:false}, s));
  });
  saveState();
  renderAll();
}

/* ---------------------------
   ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø£Ø­Ø¯Ø§Ø« (wire UI)
   --------------------------- */
function wireUI(){
  // Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
  document.getElementById('addBtn').addEventListener('click', onAddButton);
  document.getElementById('addExampleBtn').addEventListener('click', ()=> {
    addExampleTasks();
    showToast('Ø£Ø¶ÙŠÙØª Ù…Ù‡Ø§Ù… ØªØ¬Ø±ÙŠØ¨ÙŠØ©');
  });
  document.getElementById('notificationBtnTop').addEventListener('click', ()=> {
    requestNotificationPermissionFromBrowser().then(enabled => {
      if(enabled) showToast('âœ… ØªÙ… ØªÙØ¹ÙŠÙ„ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…ØªØµÙØ­');
      else showToast('âš ï¸ Ù„Ù… ÙŠØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª');
    });
  });

  // Theme toggle
  document.getElementById('themeToggle').addEventListener('click', ()=> {
    const newTheme = (STATE.settings.theme === 'light') ? 'dark' : 'light';
    applyTheme(newTheme);
    STATE.settings.theme = newTheme;
    saveState();
  });

  // Ø§Ù„Ø¨Ø­Ø«
  document.getElementById('searchInput').addEventListener('input', (e)=> {
    const v = e.target.value.trim();
    document.getElementById('liveSearchMeta').textContent = v ? v : '-';
    renderAll();
  });
  document.getElementById('clearSearch').addEventListener('click', ()=> {
    document.getElementById('searchInput').value = '';
    document.getElementById('liveSearchMeta').textContent = '-';
    renderAll();
  });

  // Filter & Sort Sidebar
  const filterSelect = document.getElementById('filterSelect');
  const sortSelect = document.getElementById('sortSelect');
  filterSelect.value = STATE.settings.filterBy || 'all';
  sortSelect.value = STATE.settings.sortBy || 'priority';
  filterSelect.addEventListener('change', (e)=> {
    STATE.settings.filterBy = e.target.value;
    saveState();
    renderAll();
  });
  sortSelect.addEventListener('change', (e)=> {
    STATE.settings.sortBy = e.target.value;
    saveState();
    renderAll();
  });

  // Nav
  document.getElementById('navTasks').addEventListener('click', ()=> switchPage('tasks'));
  document.getElementById('navAchievements').addEventListener('click', ()=> switchPage('achievements'));
  document.getElementById('navSettings').addEventListener('click', ()=> switchPage('settings'));

  // Clear all
  document.getElementById('clearAllBtn').addEventListener('click', ()=> {
    if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ù…Ù‡Ø§Ù…ØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡')) {
      STATE.tasks = [];
      saveState();
      renderAll();
      showToast('ØªÙ… Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ù…Ù‡Ø§Ù…');
    }
  });

  // Export / Import
  document.getElementById('exportBtn').addEventListener('click', exportJSON);
  document.getElementById('exportJSON').addEventListener('click', exportJSON);
  document.getElementById('importJSON').addEventListener('click', ()=> {
    document.getElementById('importFileInput').click();
  });
  document.getElementById('importFileInput').addEventListener('change', handleImportFile);

  // Settings selects
  document.getElementById('alarmSoundSelect').value = STATE.settings.alarmSound || 'beep';
  document.getElementById('alarmSoundSelect').addEventListener('change', (e)=> {
    STATE.settings.alarmSound = e.target.value;
    saveState();
  });
  document.getElementById('autoReminderSelect').value = STATE.settings.autoReminder || 'off';
  document.getElementById('autoReminderSelect').addEventListener('change', (e)=> {
    STATE.settings.autoReminder = e.target.value;
    saveState();
  });

  // Modal actions
  document.getElementById('modalCancel').addEventListener('click', closeModal);
  document.getElementById('modalSave').addEventListener('click', saveModalEdits);

  // Add form enter
  document.getElementById('titleInput').addEventListener('keydown', (e)=> {
    if(e.key === 'Enter') onAddButton();
  });

  // Export full backup on Ctrl+E (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
  document.addEventListener('keydown', (e)=> {
    if(e.ctrlKey && e.key.toLowerCase() === 'e') {
      e.preventDefault();
      exportJSON();
    }
  });

  // render notification button state
  renderNotificationButton();
}

/* ---------------------------
   Apply theme (light/dark)
   --------------------------- */
function applyTheme(theme){
  STATE.settings.theme = theme;
  if(theme === 'dark'){
    document.body.classList.add('dark');
  }else{
    document.body.classList.remove('dark');
  }
}

/* ---------------------------
   Render notification button text
   --------------------------- */
function renderNotificationButton(){
  const btn = document.getElementById('notificationBtnTop');
  if(STATE.settings.notificationsEnabled || Notification.permission === 'granted'){
    btn.textContent = 'âœ… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù…ÙØ¹Ù„Ù‘ÙØ©';
    btn.classList.remove('btn-primary');
    btn.classList.add('btn-ghost');
  }else{
    btn.textContent = 'ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª';
    btn.classList.add('btn-primary');
    btn.classList.remove('btn-ghost');
  }
}

/* ---------------------------
   Switch page: tasks / achievements / settings
   --------------------------- */
function switchPage(name){
  document.getElementById('pageTasks').style.display = name === 'tasks' ? '' : 'none';
  document.getElementById('pageAchievements').style.display = name === 'achievements' ? '' : 'none';
  document.getElementById('pageSettings').style.display = name === 'settings' ? '' : 'none';
  document.getElementById('pageTitle').textContent = name === 'tasks' ? 'Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‡Ø§Ù…' : (name === 'achievements' ? 'Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª' : 'Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª');
}

/* ---------------------------
   Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø© (Ù…Ù† Ø§Ù„ÙÙˆØ±Ù…)
   --------------------------- */
function onAddButton(){
  const title = document.getElementById('titleInput').value.trim();
  const date = document.getElementById('dateInput').value;
  const time = document.getElementById('timeInput').value;
  const priority = document.getElementById('priorityInput').value;
  const status = document.getElementById('statusInput').value;

  if(!title){
    alert('âš ï¸ Ø§ÙƒØªØ¨ Ø¹Ù†ÙˆØ§Ù† Ù„Ù„Ù…Ù‡Ù…Ø©');
    return;
  }

  const newTask = {
    id: uid(),
    title,
    date,
    time,
    priority,
    status,
    createdAt: new Date().toISOString(),
    notified: false
  };
  STATE.tasks.push(newTask);
  document.getElementById('titleInput').value = '';
  document.getElementById('dateInput').value = '';
  document.getElementById('timeInput').value = '';
  document.getElementById('priorityInput').value = 'Ø¹Ø§Ø¯ÙŠØ©';
  document.getElementById('statusInput').value = 'pending';

  saveState();
  renderAll();

  // Ø§Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù…Ù‡Ù…Ø© Ù‚Ø§Ø¯Ù…Ø© ÙÙŠ Ù†ÙØ³ Ø§Ù„Ù„Ø­Ø¸Ø© â€”ØªØ¹Ù„Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…â€”
  showToast('âœ… ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù‡Ù…Ø©');
}

/* ---------------------------
   Render all: tasks + stats + achievements
   --------------------------- */
function renderAll(){
  renderTasksList();
  renderStats();
  renderAchievements();
  renderNotificationButton();
}

/* ---------------------------
   Filter + Sort + Search ØªØ·Ø¨ÙŠÙ‚ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¹Ø±Ø¶
   --------------------------- */
function getVisibleTasks(){
  const searchQ = document.getElementById('searchInput').value.trim().toLowerCase();
  const filter = STATE.settings.filterBy || 'all';
  const sortBy = STATE.settings.sortBy || 'priority';
  let list = [...STATE.tasks];

  // ÙÙ„ØªØ±
  if(filter !== 'all'){
    list = list.filter(t => t.status === filter);
  }

  // Ø¨Ø­Ø«
  if(searchQ){
    list = list.filter(t => (t.title || '').toLowerCase().includes(searchQ));
  }

  // ØªØ±ØªÙŠØ¨
  const priorityOrder = {'Ù‡Ø§Ù…Ø© Ø¬Ø¯Ù‹Ø§':1,'Ù…ØªÙˆØ³Ø·Ø©':2,'Ø¹Ø§Ø¯ÙŠØ©':3};
  if(sortBy === 'priority'){
    list.sort((a,b) => (priorityOrder[a.priority]||9) - (priorityOrder[b.priority]||9));
  } else if(sortBy === 'date-asc'){
    list.sort((a,b) => {
      if(!a.date) return 1; if(!b.date) return -1;
      return new Date(a.date + 'T' + (a.time||'00:00')) - new Date(b.date + 'T' + (b.time||'00:00'));
    });
  } else if(sortBy === 'date-desc'){
    list.sort((a,b) => {
      if(!a.date) return 1; if(!b.date) return -1;
      return new Date(b.date + 'T' + (b.time||'00:00')) - new Date(a.date + 'T' + (a.time||'00:00'));
    });
  } else if(sortBy === 'created-desc'){
    list.sort((a,b) => new Date(b.createdAt) - new Date(a.createdAt));
  } else if(sortBy === 'created-asc'){
    list.sort((a,b) => new Date(a.createdAt) - new Date(b.createdAt));
  }

  return list;
}

/* ---------------------------
   Render Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‡Ø§Ù… Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹
   --------------------------- */
function renderTasksList(){
  const container = document.getElementById('tasksList');
  container.innerHTML = '';
  const visible = getVisibleTasks();

  if(visible.length === 0){
    container.innerHTML = `<div style="text-align:center;color:var(--muted);padding:40px;background:var(--card);border-radius:12px">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ù„Ù„Ø¹Ø±Ø¶</div>`;
    return;
  }

  visible.forEach(task => {
    const el = document.createElement('div');
    el.className = 'task priority-' + priorityToClass(task.priority);
    el.setAttribute('data-id', task.id);

    // left part
    const left = document.createElement('div');
    left.className = 'left';

    const tick = document.createElement('div');
    tick.className = 'tick';
    tick.innerHTML = task.status === 'done' ? 'âœ”' : (task.priority === 'Ù‡Ø§Ù…Ø© Ø¬Ø¯Ù‹Ø§' ? 'â€¼' : (task.priority === 'Ù…ØªÙˆØ³Ø·Ø©' ? 'â€¢' : 'â—‹'));
    left.appendChild(tick);

    const mainInfo = document.createElement('div');
    const titleEl = document.createElement('div');
    titleEl.style.fontWeight = '800';
    titleEl.textContent = task.title;
    mainInfo.appendChild(titleEl);

    const meta = document.createElement('div');
    meta.className = 'meta';
    meta.textContent = `${formatDateTime(task.date, task.time)} â€¢ ${task.priority}`;
    mainInfo.appendChild(meta);

    left.appendChild(mainInfo);
    el.appendChild(left);

    // actions
    const actions = document.createElement('div');
    actions.className = 'actions';

    // status badge
    const badge = document.createElement('div');
    badge.className = 'badge ' + (task.status === 'done' ? 'status-done' : (task.status === 'cancel' ? 'status-cancel' : 'status-pending'));
    badge.textContent = task.status === 'done' ? 'ØªÙ…Øª' : (task.status === 'cancel' ? 'Ù…Ù„ØºØ§Ø©' : 'Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°');
    actions.appendChild(badge);

    // edit button
    const editBtn = document.createElement('button');
    editBtn.className = 'icon-btn edit-btn';
    editBtn.textContent = 'âœï¸';
    editBtn.title = 'ØªØ¹Ø¯ÙŠÙ„';
    editBtn.addEventListener('click', ()=> openEditModal(task.id));
    actions.appendChild(editBtn);

    // alarm button
    const alarmBtn = document.createElement('button');
    alarmBtn.className = 'icon-btn alarm-btn';
    alarmBtn.textContent = 'â°';
    alarmBtn.title = 'Ø¶Ø¨Ø· Ù…Ù†Ø¨Ù‡';
    alarmBtn.addEventListener('click', ()=> setAlarmForTask(task.id));
    actions.appendChild(alarmBtn);

    // delete button
    const delBtn = document.createElement('button');
    delBtn.className = 'icon-btn delete-btn';
    delBtn.textContent = 'ğŸ—‘ï¸';
    delBtn.title = 'Ø­Ø°Ù';
    delBtn.addEventListener('click', ()=> {
      if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù‡Ù…Ø©ØŸ')){
        STATE.tasks = STATE.tasks.filter(t => t.id !== task.id);
        saveState();
        renderAll();
        showToast('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù‡Ù…Ø©');
      }
    });
    actions.appendChild(delBtn);

    el.appendChild(actions);

    container.appendChild(el);
  });
}

/* ---------------------------
   ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© Ø¥Ù„Ù‰ Ø§Ø³Ù… ÙƒÙ„Ø§Ø³ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ
   --------------------------- */
function priorityToClass(p){
  if(p === 'Ù‡Ø§Ù…Ø© Ø¬Ø¯Ù‹Ø§') return 'high';
  if(p === 'Ù…ØªÙˆØ³Ø·Ø©') return 'medium';
  return 'normal';
}

/* ---------------------------
   ÙØªØ­ Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù…Ø¹ Ù…Ù„Ø£ Ø§Ù„Ù‚ÙŠÙ…
   --------------------------- */
function openEditModal(taskId){
  const task = STATE.tasks.find(t=>t.id === taskId);
  if(!task) return;
  STATE.ui.editingTaskId = taskId;
  document.getElementById('modalTitleInput').value = task.title;
  document.getElementById('modalDateInput').value = task.date || '';
  document.getElementById('modalTimeInput').value = task.time || '';
  document.getElementById('modalPriorityInput').value = task.priority || 'Ø¹Ø§Ø¯ÙŠØ©';
  document.getElementById('modalStatusInput').value = task.status || 'pending';
  const backdrop = document.getElementById('modalBackdrop');
  backdrop.style.display = 'flex';
  backdrop.setAttribute('aria-hidden','false');
}

/* ---------------------------
   Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
   --------------------------- */
function closeModal(){
  STATE.ui.editingTaskId = null;
  const backdrop = document.getElementById('modalBackdrop');
  backdrop.style.display = 'none';
  backdrop.setAttribute('aria-hidden','true');
}

/* ---------------------------
   Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ù…Ù† Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
   --------------------------- */
function saveModalEdits(){
  const id = STATE.ui.editingTaskId;
  if(!id) return closeModal();
  const title = document.getElementById('modalTitleInput').value.trim();
  const date = document.getElementById('modalDateInput').value;
  const time = document.getElementById('modalTimeInput').value;
  const priority = document.getElementById('modalPriorityInput').value;
  const status = document.getElementById('modalStatusInput').value;

  const task = STATE.tasks.find(t=>t.id === id);
  if(!task) return closeModal();

  task.title = title || task.title;
  task.date = date;
  task.time = time;
  task.priority = priority;
  task.status = status;

  saveState();
  renderAll();
  closeModal();
  showToast('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª');
}

/* ---------------------------
   Ø¶Ø¨Ø· Ù…Ù†Ø¨Ù‡ Ù„Ù…Ù‡Ù…Ø© Ø¨Ø¹ÙŠÙ†Ù‡Ø§ (setAlarm)
   --------------------------- */
function setAlarmForTask(taskId){
  const task = STATE.tasks.find(t => t.id === taskId);
  if(!task) return;
  if(!task.date || !task.time){
    // Ø¥Ø´Ø¹Ø§Ø± ÙÙˆØ±ÙŠ Ø¥Ù† Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ ÙˆÙ‚Øª
    playAlarmSound();
    showDesktopNotification('Ù…Ù†Ø¨Ù‡ Ù„Ù„Ù…Ù‡Ù…Ø©', `Ø§Ù„Ù…Ù‡Ù…Ø©: ${task.title} (Ø¨Ø¯ÙˆÙ† ØªØ§Ø±ÙŠØ®/ÙˆÙ‚Øª Ù…Ø­Ø¯Ø¯)`, task.id);
    showInternalPopup('ØªÙ†Ø¨ÙŠÙ‡', `Ø§Ù„Ù…Ù‡Ù…Ø©: ${task.title} (Ø¨Ø¯ÙˆÙ† ØªØ§Ø±ÙŠØ®/ÙˆÙ‚Øª Ù…Ø­Ø¯Ø¯)`);
    return;
  }
  const due = new Date(task.date + 'T' + task.time);
  const now = new Date();
  const diff = due.getTime() - now.getTime();
  if(diff <= 0){
    // Ø£Ø±Ø³Ù„ ÙÙˆØ±Ù‹Ø§
    playAlarmSound();
    showDesktopNotification('â° Ù…Ù†Ø¨Ù‡ Ø§Ù„Ù…Ù‡Ù…Ø©', `Ø§Ù„Ù…Ù‡Ù…Ø©: ${task.title} â€” Ù…ÙˆØ¹Ø¯Ù‡Ø§ Ø§Ù„Ø¢Ù†`, task.id);
    alert('ğŸ”” Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù…Ù‡Ù…Ø© Ù‚Ø¯ Ø­Ø§Ù†!');
  } else {
    // Ø¶Ø¨Ø· setTimeout (Ù…Ù„Ø§Ø­Ø¸Ø©: Ø³ÙŠØ¹Ù…Ù„ ÙÙ‚Ø· Ø·Ø§Ù„Ù…Ø§ Ø§Ù„ØµÙØ­Ø© Ù…ÙØªÙˆØ­Ø©)
    setTimeout(()=> {
      playAlarmSound();
      showDesktopNotification('â° Ù…Ù†Ø¨Ù‡ Ø§Ù„Ù…Ù‡Ù…Ø©', `Ø§Ù„Ù…Ù‡Ù…Ø©: ${task.title} â€” ÙˆÙ‚ØªÙ‡Ø§ Ø§Ù„Ø¢Ù†`, task.id);
      showInternalPopup('Ù…Ù†Ø¨Ù‡ Ø§Ù„Ù…Ù‡Ù…Ø©', `Ø§Ù„Ù…Ù‡Ù…Ø©: ${task.title} â€” ${formatDateTime(task.date,task.time)}`);
    }, diff);
    showToast('âœ… ØªÙ… Ø¶Ø¨Ø· Ø§Ù„Ù…Ù†Ø¨Ù‡ (ÙŠØ¹Ù…Ù„ Ø·Ø§Ù„Ù…Ø§ Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© Ù…ÙØªÙˆØ­Ø©)');
  }
}

/* ---------------------------
   Render Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª: Ø¥Ø¬Ù…Ø§Ù„ÙŠØŒ Ù…ÙƒØªÙ…Ù„ØŒ Ù†Ø³Ø¨Ø© Ø¥Ù†Ø¬Ø§Ø²ØŒ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
   --------------------------- */
function renderStats(){
  const total = STATE.tasks.length;
  const done = STATE.tasks.filter(t=>t.status === 'done').length;
  const cancel = STATE.tasks.filter(t=>t.status === 'cancel').length;
  const percent = total === 0 ? 0 : Math.round((done/total)*100);

  document.getElementById('totalCount').textContent = total;
  document.getElementById('doneCount').textContent = done;
  document.getElementById('progressPercent').textContent = percent + '%';
  document.getElementById('progressFill').style.width = percent + '%';
  document.getElementById('achTotal').textContent = total;
  document.getElementById('achDone').textContent = done;
  document.getElementById('achCancel').textContent = cancel;
  document.getElementById('achPercent').textContent = percent + '%';
}

/* ---------------------------
   Render ØµÙØ­Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª: Ø¨Ø·Ø§Ù‚Ø§Øª Ø¨Ø³ÙŠØ·Ø©
   --------------------------- */
function renderAchievements(){
  const list = document.getElementById('achList');
  list.innerHTML = '';
  const total = STATE.tasks.length;
  const done = STATE.tasks.filter(t=>t.status === 'done').length;

  // Ø¨Ø·Ø§Ù‚Ø§Øª Ø«Ø§Ø¨ØªØ©/Ø´Ø±Ø·ÙŠØ©
  addAchCard(list, 'Ø£ÙˆÙ„ Ù…Ù‡Ù…Ø©', 'Ø£Ø¶ÙØª Ø£ÙˆÙ„ Ù…Ù‡Ù…Ø©', total >= 1);
  addAchCard(list, '5 Ù…Ù‡Ø§Ù…', 'Ø£Ø¶ÙØª 5 Ù…Ù‡Ø§Ù…', total >= 5);
  addAchCard(list, '10 Ù…Ù‡Ø§Ù…', 'Ø£Ø¶ÙØª 10 Ù…Ù‡Ø§Ù…', total >= 10);
  addAchCard(list, 'Ù…Ù‡Ù…Ø© Ù…ÙƒØªÙ…Ù„Ø©', 'Ø£ØªÙ…Ù…Øª Ù…Ù‡Ù…Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', done >= 1);
  addAchCard(list, '10 Ù…Ù‡Ø§Ù… Ù…ÙƒØªÙ…Ù„Ø©', 'Ø£ØªÙ…Ù…Øª 10 Ù…Ù‡Ø§Ù…', done >= 10);
}

/* ---------------------------
   Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø© Ø¥Ù†Ø¬Ø§Ø²
   --------------------------- */
function addAchCard(container, title, desc, unlocked){
  const el = document.createElement('div');
  el.className = 'ach-card';
  el.innerHTML = `<div style="font-size:18px;font-weight:800">${title}</div>
                  <div style="font-size:13px;color:var(--muted);margin-top:6px">${desc}</div>
                  <div style="height:10px"></div>
                  <div style="font-weight:800;color:${unlocked ? 'var(--success)' : 'var(--muted)'}">${unlocked ? 'ğŸ”“ Ù…ÙØªÙˆØ­Ø©' : 'ğŸ”’ Ù…ØºÙ„Ù‚Ø©'}</div>`;
  container.appendChild(el);
}

/* ---------------------------
   Export JSON (ØªÙ†Ø²ÙŠÙ„ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©)
   --------------------------- */
function exportJSON(){
  const payload = JSON.stringify({tasks: STATE.tasks, settings: STATE.settings}, null, 2);
  const blob = new Blob([payload], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'mytasks_backup_' + (new Date().toISOString().slice(0,10)) + '.json';
  a.click();
  URL.revokeObjectURL(url);
  showToast('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©');
}

/* ---------------------------
   Import file handler
   --------------------------- */
function handleImportFile(e){
  const file = e.target.files[0];
  if(!file) return;
  const reader = new FileReader();
  reader.onload = function(ev){
    try{
      const parsed = JSON.parse(ev.target.result);
      if(parsed.tasks && Array.isArray(parsed.tasks)){
        if(confirm('Ø³ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¨Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø³ØªÙˆØ±Ø¯. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©ØŸ')){
          STATE.tasks = parsed.tasks;
          if(parsed.settings) STATE.settings = Object.assign(STATE.settings, parsed.settings);
          saveState();
          renderAll();
          showToast('âœ… ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
        }
      } else {
        alert('âš ï¸ Ø§Ù„Ù…Ù„Ù Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù‡Ø§Ù… ØµØ§Ù„Ø­Ø©.');
      }
    }catch(err){
      alert('âš ï¸ Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù: ' + err.message);
    }
  };
  reader.readAsText(file);
}

/* ---------------------------
   Ù…Ø³Ø§Ø¹Ø¯Ø©: Toast Ø¨Ø³ÙŠØ·Ø©
   --------------------------- */
let toastTimer = null;
function showToast(msg, ms=2200){
  let t = document.getElementById('globalToast');
  if(!t){
    t = document.createElement('div');
    t.id = 'globalToast';
    t.style.position = 'fixed';
    t.style.bottom = '22px';
    t.style.left = '50%';
    t.style.transform = 'translateX(-50%)';
    t.style.background = 'linear-gradient(90deg,var(--accent),var(--accent-2))';
    t.style.color = '#fff';
    t.style.padding = '10px 18px';
    t.style.borderRadius = '999px';
    t.style.boxShadow = '0 10px 30px rgba(0,0,0,0.3)';
    t.style.fontWeight = '700';
    t.style.zIndex = '999999';
    document.body.appendChild(t);
  }
  t.textContent = msg;
  t.style.opacity = '1';
  if(toastTimer) clearTimeout(toastTimer);
  toastTimer = setTimeout(()=> {
    t.style.opacity = '0';
  }, ms);
}

/* ---------------------------
   Helper: show/hide modal popup (used Ù„Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª)
   --------------------------- */
/* ---------------------------
   Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† ØªØ¹Ù„ÙŠÙ‚Ø§Øª ÙˆÙ…Ø­ØªÙˆÙ‰ Ù„Ø²ÙŠØ§Ø¯Ø© Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø·ÙˆØ± ÙƒÙ…Ø§ Ø·Ù„Ø¨Øª
   Ù‡Ø°Ù‡ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª ØªÙˆØ¶Ø­ Ø¨Ù†ÙŠØ© Ø§Ù„Ù…Ù„Ù Ù„ÙƒÙ† Ù„Ø§ ØªØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¯Ø§Ø¡
   --------------------------- */

/* ............................................................
   Ø§Ù„Ù‚Ø³Ù… Ø§Ù„ØªØ§Ù„ÙŠ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ÙˆØ¸Ø§Ø¦Ù Ù…Ø³Ø§Ø¹Ø¯Ø© Ø¥Ø¶Ø§ÙÙŠØ© Ù„ØªÙˆÙ„ÙŠØ¯
   Ø§Ù„Ù…Ø­ØªÙˆÙ‰ØŒ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµØ­Ø©ØŒ ÙˆØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù†ØµÙˆØµ. Ù†Ø±ÙƒØ² Ù‡Ù†Ø§ Ø¹Ù„Ù‰
   Ù‚Ø§Ø¨Ù„ÙŠØ© Ø§Ù„ØªÙˆØ³Ø¹ ÙˆØ³Ù‡ÙˆÙ„Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù„Ø§Ø­Ù‚Ù‹Ø§.
   ............................................................ */

/* ---------------------------
   ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù†ØµÙˆØµ
   --------------------------- */
function sanitizeText(t){
  if(!t) return '';
  // Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø£Ø­Ø±Ù ØºØ±ÙŠØ¨Ø© ÙˆÙ…Ø®Ø§Ø·Ø± XSS Ø§Ù„Ø¨Ø³ÙŠØ·Ø©
  return t.replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

/* ---------------------------
   ÙˆØ¸Ø§Ø¦Ù Ø¥Ø¶Ø§ÙÙŠØ©: findTask, updateTaskStatus etc.
   --------------------------- */
function findTaskById(id){ return STATE.tasks.find(t => t.id === id); }

function updateTaskStatus(id, newStatus){
  const t = findTaskById(id);
  if(!t) return;
  t.status = newStatus;
  saveState();
  renderAll();
}

/* ---------------------------
   Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ÙˆØ§Ø¬Ù‡Ø§Øª: Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ù†Ù‚Ø±ØªÙŠÙ† Ù„ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø© Ø¨Ø³Ø±Ø¹Ø©
   --------------------------- */
document.addEventListener('dblclick', (e) => {
  const el = e.target.closest('.task');
  if(!el) return;
  const id = el.getAttribute('data-id');
  if(!id) return;
  const t = findTaskById(id);
  if(!t) return;
  // ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† pending -> done -> cancel -> pending
  if(t.status === 'pending') t.status = 'done';
  else if(t.status === 'done') t.status = 'cancel';
  else t.status = 'pending';
  saveState();
  renderAll();
  showToast('ğŸ” ØªÙ… ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ù‡Ù…Ø©');
});

/* ---------------------------
   event: Ø¹Ù†Ø¯ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù€ modalBackdrop Ø¨Ø§Ù„Ø¶ØºØ· Ø®Ø§Ø±Ø¬Ù‡
   --------------------------- */
document.getElementById('modalBackdrop').addEventListener('click', (e)=> {
  if(e.target === e.currentTarget) closeModal();
});

/* ---------------------------
   Ù…Ù„Ù: ØªØ­Ù…ÙŠÙ„ Ø¹ÙŠÙ†Ø© Ù„ØªÙˆÙ„ÙŠØ¯ Ù…Ù‡Ø§Ù… ÙƒØ«ÙŠØ±Ø© (Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø£Ø¯Ø§Ø¡)
   --------------------------- */
function generateManyTasks(count=100){
  for(let i=0;i<count;i++){
    STATE.tasks.push({
      id: uid(),
      title: `Ù…Ù‡Ù…Ø© Ø§Ø®ØªØ¨Ø§Ø±ÙŠØ© ${i+1}`,
      date: Math.random() > 0.6 ? nowISODate() : '',
      time: Math.random() > 0.6 ? ('0' + (Math.floor(Math.random()*24))).slice(-2) + ':' + (Math.floor(Math.random()*60)).toString().padStart(2,'0') : '',
      priority: (Math.random() > 0.7) ? 'Ù‡Ø§Ù…Ø© Ø¬Ø¯Ù‹Ø§' : (Math.random() > 0.4 ? 'Ù…ØªÙˆØ³Ø·Ø©' : 'Ø¹Ø§Ø¯ÙŠØ©'),
      status: Math.random() > 0.8 ? 'done' : 'pending',
      createdAt: new Date().toISOString(),
      notified: false
    });
  }
  saveState();
  renderAll();
  showToast(`âœ… ØªÙ… ØªÙˆÙ„ÙŠØ¯ ${count} Ù…Ù‡Ù…Ø© Ø§Ø®ØªØ¨Ø§Ø±ÙŠØ©`);
}

/* ---------------------------
   Ù…Ø¹Ø§Ù„Ø¬Ø© Ø­Ø¯Ø« export/import Ø¥Ø¶Ø§ÙÙŠ
   --------------------------- */
document.getElementById('exportBtn').addEventListener('click', exportJSON);

/* ---------------------------
   END OF JS - for now
   --------------------------- */

/* Ø¨Ø¹Ø¶ Ø£Ø³Ø·Ø± Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø·ÙˆÙ„ ÙƒÙ…Ø§ Ø·Ù„Ø¨Øª:
   - ÙŠÙ…ÙƒÙ†Ùƒ Ø·Ù„Ø¨ ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„ØªØµÙ…ÙŠÙ…
   - Ø¥Ø¶Ø§ÙØ© Ù…Ø²Ø§Ù…Ù†Ø© Ø¹Ø¨Ø± Ø§Ù„Ø³Ø­Ø§Ø¨Ø© (Ù…Ø³ØªÙ‚Ø¨Ù„Ù‹Ø§)
   - Ø¥Ø¶Ø§ÙØ© ØªØ³Ø¬ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ùˆ multi-device sync
   - ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¥Ù„Ù‰ PWA
   - Ø¥Ø¶Ø§ÙØ© Ø¯Ø¹Ù… Ù„Ù„ØªØ°ÙƒÙŠØ±Ø§Øª Ø§Ù„Ù…ØªØ²Ø§Ù…Ù†Ø© Ø­ØªÙ‰ Ù„Ùˆ ÙƒØ§Ù†Øª Ø§Ù„ØµÙØ­Ø© Ù…ØºÙ„Ù‚Ø© (Background sync / service workers)
*/

/* ........................................................................ */
/* ........................................................................ */
/* ........................................................................ */
/* ........................................................................ */
/* ........................................................................ */
/* ........................................................................ */
/* ........................................................................ */
/* ........................................................................ */
/* ........................................................................ */
</script>
<!-- ######################################## -->
<!-- # Ù‡Ù†Ø§ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠ Ø§Ù„Ù„ÙŠ Ù‡ØªØ²ÙˆØ¯Ù‡ ÙŠØ§ Ù…ÙŠØ¯Ùˆ -->
<!-- ######################################## -->

<script>
window.addEventListener("load", () => {
  const splash = document.getElementById("splash");
  if (splash) {
    // B: Ø¨Ø¯Ø§ÙŠØ© Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
    setTimeout(() => {
      splash.style.transition = "opacity 0.6s ease";
      splash.style.opacity = "0";

      // C: Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ù†ÙŠÙ…ÙŠØ´Ù†ØŒ Ù†Ø®ÙÙŠ Ø§Ù„Ø¹Ù†ØµØ± Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§
      setTimeout(() => {
        splash.style.display = "none";
      }, 600);
    }, 2000); // Ø§Ù„ÙˆÙ‚Øª Ù‚Ø¨Ù„ Ø¨Ø¯Ø¡ Ø§Ù„Ø¥Ø®ÙØ§Ø¡
  }
});
</script>
</body>
</html>

